![Image1forYellowstone](https://github.com/MorpheusAIs/Morpheus/assets/1563345/80a6c1cf-fe52-42ba-bfd4-91d9faf67f07)

# Модель Вычислений Морфеус “Yellowstone” 
### Erik Voorhees
### 3 января 2024

Предложенная редакция структуры токеномики Morpheus для стимулирования вычислений в децентрализованной сети ИИ.  
Просмотр в Notion: https://defiant-wolfsbane-830.notion.site/Morpheus-Yellowstone-Compute-Model-2ca9b4e7e1374c898937fdbd1b964cc1


## Краткое содержание
В модели вычислений Yellowstone сеть Morpheus выплачивает провайдерам вознаграждение только за фактически предоставленные вычислительные мощности через конкурентный процесс торгов, а также выделяет ограниченный выпуск IPS (операции вывода в секункду) (прим. единица измерения запросов к ИИ) пропорционально количеству удерживаемых токенов MOR, а не на основе платежей. Это существенно улучшает пользовательский опыт, минимизируя при этом уязвимость к атакам типа Sybil. Yellowstone также вводит важные метрики времени и прохождения теста "Pass/Fail", чтобы гарантировать, что поставщики вычислений действуют достаточно оперативно и точно. Yellowstone сохраняет конфиденциальность, не направляя запросы или результаты через маршрутизатор, и минимизирует транзакции в блокчейне для обеспечения масштабируемости. С помощью этой модели MOR приобретает фундаментальную ценность, предоставляя постоянный (но ограниченный) доступ к вычислениям без необходимости проведения транзакций на каждую операцию вывода.

Если данное предложение будет принято, оно заменит раздел "Compute Proof, Registration & Reward" в [белой книге Morpheus](https://github.com/MorpheusAIs/Morpheus/blob/main/Whitepaper-International/WhitePaper%20Russian.md)

## Контекст
Morpheus использует токеномику для стимулирования предоставления достаточного и масштабируемого вычислительного ресурса для децентрализованного и неограниченного генеративного ИИ. В первоначальной концепции Morpheus выделял 24% эмиссии MOR напрямую провайдерам вычислительных мощностей, пропорционально полученным запросам, и отдавал приоритет в запросах тем провайдерам, у которых было больше MOR.

### Из оригинальной белой книги:
`"MOR-комиссии за транзакции, сжигаемые каждым провайдером вычислений, служат доказательством его статуса и приносят ему пропорциональную долю токенов MOR каждый день.`

`Например, если существует 100 провайдеров вычислений в день запуска сети, то каждый из них получит пропорциональное вознаграждение в зависимости от количества MOR, которое он сжег через комиссии. В данном случае, предположим, что каждый из 100 провайдеров вычислений сжег 100 MOR, тогда 1% из 3 456 MOR ежедневно = 34.56 MOR".`

### Однако у этого подхода есть три основных проблемы:
1) Он требует от пользователей оплаты комиссии за каждую операцию вывода. Даже если это дешево, это существенное препятствие, которое вызовет плохой пользовательский опыт и постоянное отставание от OpenAI. Кроме того, требуется как минимум одна транзакция в блокчейне на каждую операцию, что, вероятно, не сможет масштабироваться даже на L2. Каждая операция имеет чрезвычайно низкую стоимость и если будет необходима транзакция в блокчейне, то операции станут экономчески нецелесообразными.  
2) Эта модель существенно подвержена уязвимостям, потому что ожидаемые доходы для провайдеров вычислений гораздо выше фактических затрат на вычисления. Таким образом, злоумышленник может засыпать свой собственный узел провайдера запросами на операции, зарабатывая относительно большую часть токенов MOR каждый день, даже если никакой экономической ценности никому не предоставлено. Это, вероятно, приведет к большим объемам неиспользуемых вычислений, которые исчезнут, как только исчезнет огромная возможность дохода, а потраченные за этот период MOR будут потеряны.
3) Если запросы на операции вывода распределяются в зависимости от количества MOR, удерживаемого провайдерами, то сеть игнорирует производительность этих провайдеров (время отклика) и стоимость их вычислительной обработки. Именно эти два фактора сеть должна пытаться оптимизировать (время отклика и стоимость вычислений должны стремиться быть минимальными). Если провайдер с наибольшим количеством MOR использует GPU за 200 долларов, выпущенную когда он еще учился в колледже, производительность операций для многих пользователей будет чрезвычайно низкой. Приоритет должен базироваться на цене предложения вычислений и производительности, а не количестве удерживаемых MOR. 

Ниже представлена модель "Yellowstone", которая модифицирует токеномику Morpheus для предоставления вычислительных ресурсов, чтобы решить указанные выше проблемы. Эта модель работает независимо от того, какая часть эмиссии выделена на вычисления, и мы будем предполагать сохранение текущего статуса, где 24% общей эмиссии выделено на вычисления.

### Цели:
1) Позволить пользователям не платить за каждую операцию вывода (в идеале, вообще не платить)
2) Достигнуть эффективного, масштабируемого и устойчивого предоставления вычислительных ресурсов без переплаты
3) Стимулировать конкуренцию по времени отклика и стоимости среди поставщиков вычислительных ресурсов
4) Минимизировать количество блокчейн-транзакций (будь то L2 или другие)
5) Продемонстрировать экономически обоснованный фундаментальный спрос на MOR

## Модель Yellowstone
Включает в себя четыре компонента:

### Пользователи
- Имеют запросы
- Хотят быстрого/точного вычисления бесплатно и без цензуры/наблюдения
  
### Провайдеры
- Имеют вычислительные ресурсы
- Хотят денег (MOR)

### Маршрутизатор
- Имеет высокую пропускную способностью
- Децентрализован

### Контракт вычислений
- Общедоступный смарт-контракт, который получает эмиссию MOR, отслеживает начисления и удержания у поставщиков и выплачивает им награды при вызове

## Стандартные меры и величины
В ИИ есть атомная единица операций выводов измеряемая в выводах в секунду (inferences/second IPS). Это можно концептуально сравнить с WEI на блокчейне. Выводы используются для определения тарифов в маршрутизаторе Yellowstone. Вес одной единицы искусственного интеллекта Morpheus, следовательно, представляет собой вывод. В зависимости от типа запроса это может быть применено к любой вычислительной задаче.

По мере слияния ИИ и блокчейна, Morpheus стремится предоставить открытый стандарт измерений, чтобы уточнить терминологию, используемую как ИИ, так и блокчейном.

Существует два типа запросов, определенных размером возвращаемого моделью ответа:  

**Запросы с определенной длиной**, где ответ учитывает длину возвращаемого ответа. Примеры включают:
- Чат/Создание изображения
- Диагностика болезней
- Распознавание объектов
- Выявление мошенничества

**Запросы с неопределенной длиной** требуют ресурсов для ответа, которые можно узнать только после создания ответа. Примеры таких запросов:
- Спой сонату о спагетти
- Создай видеопоздравление С днем рождения
- Совмести модель X с моделью Y
- Разрежь 3D-модель в файл .stl

Yellowstone фокусируется на запросах с определенной длиной. Описанный маршрутизатор будет построен так, чтобы в будущем обрабатывать также и запросы с неопределенной длиной, но не для обслуживания их сегодня. Для достижения этого мы используем стандартизированное измерение децентрализованного ИИ (DeAI).

## Тарифы децентрализованного ИИ

### Выражения вывода в секунду:

| Тип | Ответ | Тариф |
|------|----------|------|
| Определенный | Язык | Выведенные Токены в секунду (TPS) |
| Неопределенный - медиа | Аудио | Выведенные образцы в секунду (ISPS) |
| Неопределенный - медиа | Видео | Выведенные кадры в секунду (IFPS) |
| Неопределенный - будущие технологии | Неизвестный будущий формат | Н/Д |

Первой единицей измерения операций вывода для маршрутизатора Yellowstone станут токены в секунду (TPS). Форматы других выводов будут представлены позднее.

### Время
Время блока для вывода составляет 12 секунд, что означает, что блок вывода транзакций публикуется и учитывается 5 раз в минуту.

## Определения

**"Пользователи"**: определены как любой участник, у которого есть адрес MOR и который отправляет запросы маршрутизатору на использование вычисления. Это может быть конкретное лицо, отправляющее запросы с локальной версии Morpheus, или это может быть бот, или это может быть компания или веб-сайт от третьей стороны, который взаимодействует с сетью Morpheus от имени своих конечных пользователей (использование выводов конечными пользователями не отслеживается или не учитывается в контракте вычислений, за исключением случаев сбоя операций вывода).

**"Поставщики"**: определены как любой участник, поддерживающий работу узла предоставляющего ресурсы для вычислений, имеющий адрес MOR и предлагающий ставки на IPS через маршрутизатор. Когда поставщик выигрывает ставку, он предоставляет ресурсы для вычислений (графические процессоры и т.д.) для различных пользовательских моделей ИИ.

**"Маршрутизатор"**: определен как программное приложение, имеющее адрес MOR и являющееся посредником между пользователями и поставщиками в двустороннем рынке. Маршрутизатор регистрирует и отслеживает адреса и ставки поставщиков, обрабатывает запросы от пользователей, записывает [миллисекунды], результаты тестов Pass/Fail обработанных запросов и указывает контракту, по мере необходимости, начислять средства поставщикам вычислений в MOR. Маршрутизатор никогда не отправляет и не получает транзакции MOR (или транзакции на любом блокчейне) и никогда не видит содержимого запроса или ответа.

**"Контракт вычислений"**: определен как смарт-контракт, имеющий адрес MOR, который получает всю эмиссию MOR выделенную для вычислений, отслеживает суммы, которые должны быть выплачены поставщикам, и выплачивает MOR поставщикам при запросе.

**"Выводы в секунду (IPS)"**: это атомная единица измерений операций вывода в ИИ, которая используется Маршрутизатором для определения текущей стоимости. 

**"IPSMax"** относится к максимальному количеству операций вывода, принимаемых для оплаты маршрутизатором.

**"Запрос на вычисление (RFC)"**: Пользователь отправляет RFC маршрутизатору и указывает [LLM], к которой пользователь хочет получить доступ, а также [IPSMax], который является пределом приемлемых IPS в ответе. Пользователю следует ограничивать это количество, потому что более высокие числа = более долгое ожидание ответов и считаются большим вкладом в [UserMax], который ограничен каждый день.

### Защиты контракта

Для предотвращения атак, направленных на манипулирование неиспользуемыми вычислениями, пул неиспользованных MOR, выделенных поставщикам вычислений, может уменьшаться не более чем на 1% в блок день, что соответствует обычным вычислительным эмиссиям + 1%.

### Стимул для инициализации вычислений

В течение первого года после завершения 90ти дневного периода инициализации, топ-100 поставщиков вычислений будут иметь право на пропорциональную часть в размере 2,4% от эмиссии MOR. Это рассчитывается маршрутизатором и учитывается в контракте вычислений.

## Процесс работы
1) Пользователи, Поставщики и Маршрутизатор создают публичные ключи MOR (это их идентификатор и подпись для всех сообщений).
2) Если у Пользователя положительный баланс MOR, Пользователь может отправить подписанное сообщение с запросом на обработку "RFC" Маршрутизатору. Пользователь указывает [LLM] и [IPSMax].
3) Маршрутизатор упорядочивает запросы на обработку на основе баланса MOR Пользователя (решает проблему сибила).
4) Маршрутизатор выбирает Поставщика, поддерживающего [LLM], с приоритетом наименьшей ставки IPS в MOR.
5) Маршрутизатор отправляет проверку активности Поставщику. Если проверка пройдена, то
6) Маршрутизатор соединяет Пользователя с Поставщиком.
7) Пользователь отправляет запрос ([LLM], [запрос]) поставщику.
8) Поставщик вычисляет запрос, отправляет результат пользователю.
9) Пользователь сообщает время [миллисекунды] между шагами 4 и 5, [IPS] доставлены, и результат [Pass/Fail] Маршрутизатору.
10) Маршрутизатор инструктирует Контракт Вычислений начислить Поставщику MOR, если [миллисекунд] на [IPS] не хуже чем на X% среднего значения по прошлым Z запросам для этого [LLM] и если пользователь сообщил [Pass].   
11) (Через некоторое время) Поставщик запрашивает выплату MOR из Контракта Вычислений, который отправляет выплату MOR, если она действительна.

![ComputeContractImage2](https://github.com/MorpheusAIs/Morpheus/assets/1563345/e66ea20c-9851-4f9e-9caa-66c6d798c462)

## Результат
* Пользователь получил быстрый результат для своего запроса и не заплатил ничего (это приведет к удивительному пользовательскому опыту и, следовательно, к широкому принятию). **Решает Цель 1.**
* Контракт Вычислений оплачивает вычисления через конкурентный процесс ставок и проверку качества/удовлетворенности от Пользователя, который их заказал. **Решает Цель 2.**
* Поставщик получает деньги (MOR) от Контракта Вычислений, при условии достаточно быстрого ответа. Поставщик получает ровно то, о чем просил за предоставление вычислений. Если ставка поставщика слишком высока, другие будут делать более низкие ставки, таким образом система эффективна и будет снижать цены Поставщиков к стоимости базовой электроэнергии.  **Решает Цель 3**
* Количество онлайн-транзакций было минимизировано (много тысяч запросов может проходить без единой онлайн-транзакции). **Решает Цель 4**
* Возможность получить быстрое, бесплатное вычисление стимулирует спрос на токены MOR среди пользователей. **Решает Цель 5**
* Шаги 6 и 7 обеспечивают разумную конфиденциальность (запрос никогда не касается маршрутизатора, так же как и результат). Поставщики выбираются относительно случайным образом и никогда не узнают личность Пользователя, кроме IP-адреса. Более высокий уровень конфиденциальности может быть достигнут позднее с использованием TOR + FHE.
* Баланс MOR был уменьшен из Контракта Вычислений. Контракт будет платежеспособным, пока уплаченный MOR < заработанного MOR за период от эмиссии.
* Если пользователь отправляет RFC, превышающий [UserMax] Пользователя, Маршрутизатор отклонит запрос.

-------------

## Бюджет вычислений
Сети Morpheus необходимо определить, сколько MOR она готова потратить на вычисления в определенный период (например, каждый день). Это называется Бюджетом вычислений. Каждый период Контракт Вычислений может тратить не более этого количества MOR. Это число, умноженное на цену MOR, дает нам бюджет в долларах на приобретение вычислений каждый день.

## Уровень доступа (AccessRate)
Сеть Morpheus распределяет дефицитный ресурс производства IPS через концепцию "AccessRate" (Уровень доступа). AccessRate определяет, сколько IPS каждый токен MOR может использовать в день. Неиспользованный доступ не накапливается. AccessRate всегда отображается как количество IPS на 1 токен MOR (например, 1 MOR = 15 000 IPS). AccessRate определяется частично с помощью MaxIPS, который количественно оценивает максимальное количество IPS, которые сеть может закупить в день.

**AccessRate** = (1/Общее количество MOR) * MaxIPS  
**MaxIPS** = ((Бюджет вычислений MOR * Цена MOR) / Цена IPS) * 1000  
**UserMax** = MaxIPS * Баланс MOR пользователя

### Пример показателей: 
**Общее количество MOR** = 10,000,000 MOR  
**Бюджет вычислений MOR** = 3,000 MOR в день   
**Цена MOR** = $20  
**Цена IPS** = $0.002 за 1000 IPS  
**Баланс MOR пользователя** = 5 MOR tokens  

### Пример результата:
**MaxIPS** = 30,000,000,000 IPS (максимум IPS, который сети может приобрести/произвести в день)  
**AccessRate** = 3,000 (таким образом, каждый токен MOR предоставляет доступ к 3,000 IPS в день)  
**UserMax** = 15,000 (пользователь с балансом 5 MOR может получить доступ к 15,000 IPS в день)  

- Каждый период (каждый день) Morpheus, как сеть, располагает достаточными средствами для покупки X количества IPS (вычислений) у поставщиков вычислений. X является функцией количества MOR, которое Контракт Вычислений готов потратить («Бюджет вычислений»), умноженного на текущую цену MOR и делённого на рыночную стоимость IPS.
- Если Бюджет вычислений составляет 3,000 MOR, и каждый MOR стоит $20, то сеть может купить (произвести) вычисления на сумму до $60,000 в этот день. Если текущая ставка за 1,000 IPS составляет $0.002, то сеть может купить до 30 миллиардов IPS (30 миллионов умноженные на 1000 IPS).
- Этот потенциальный объем производства в 30 миллиардов IPS распределяется пропорционально балансу MOR. Предположим, что в обращении находится 10,000,000 MOR. Пользователь с 500 токенами MOR (0.005% от общего) может свободно использовать до 1,5 миллиона IPS в этот день.
- Пока Бюджет вычислений находится на уровне или ниже уровня эмиссии, Контракт Вычислений не может исчерпать запасы MOR.
- На практике большинство токенов будут находиться в кошельках и биржах, и лишь небольшая часть будет использоваться для запроса производства IPS.

## Заметки
1) Основным спросом на MOR является желание пользователей получить доступ к генеративному ИИ и другим формам вычислений в сети Morpheus. 
 
2) Тип оборудования поставщика не имеет значения для сети, до тех пор, пока соответствует условиям Pass/Fail теста. Любой Поставщик, который будет делать ставки на большее количество запросов чем он может эффективно обрабатывать, будет наказан провалом (Fail) этого теста.

3) Приведенная выше модель важна тем, что выплачивает вознаграждение Поставщикам ТОЛЬКО при наличии спроса на их вычисления. Это предотвращает ситуацию, когда большие объемы MOR эмитируются преждевременно, когда сети это не требуется. 

4) Поставщикам следует доказать, что у них есть определенная LLM, подписывая хэш модели LLM своим ключом. Это не доказывает что они использовали модель, но это доказывает, что они загрузили и установили LLM, что представляет собой работу и тем самым предотвращает некоторые формы сибил мошенничества. Если Поставщики предоставляют Пользователю некорректные результаты, Пользователь может отправить [Fail] вместе с [миллисекундами] обратно маршрутизатору, и Поставщику не будет начислено вознаграждение за это вычисление. Morpheus не нужно, чтобы все ответы были идеальными... ему просто нужно достаточно хороших ответов по сравнению с конкурирующими альтернативами.

5) Сибил-атаки, связанные со спамом сети запросами на вычисления (RFC), предотвращаются с помощью AccessRate. "Стоимость" отправки RFC - это стоимость приобретения токена MOR, делённая на количество RFC, отправленных от его имени. Стоимость никогда не равна нулю, но пользователь не почувствует ущерб при каждом создании RFC.

6) Результат Pass/Fail определяется Пользователем и в некоторой степени контролирует качество. Пользователь передает результат прохождения/провала вместе с [миллисекундами] обратно в маршрутизатор. В случае провала (Fail), либо нет вознаграждения, либо штрафные баллы (подлежит обсуждению). У пользователя нет стимула ложно отклонять (Fail) результат вычислений Поставщика (нет денежного стимула к этому). С другой стороны, этот механизм предотвращает отправку быстрых, но бесполезных результатов Поставщиками.   
К рассмотрению: возможно, отсутствие вознаграждения при провале только в случае, если MOR пользователя > MOR поставщика. В противном случае просто отрицательный балл, который маршрутизатор может использовать в своей логике.

7) Все четыре стороны (Пользователь, Поставщик, Маршрутизатор и Контракт Вычислений) имеют уникальный адрес MOR в качестве своей идентификации. Все сообщения между сторонами требуют подписей (но большинство из них не требует  блокчейн транзакций).

8) У Поставщиков должен быть ненулевой баланс, чтобы предотвратить сибил атаки со стороны Поставщика.

9) Если критерии [миллисекунд] выше, сеть будет в целом быстрее, но отпугивая более мелких Поставщиков.

10) Существуют негативные стимулы к предоставлению медленных результатов (нет дохода после вычислений)
